Sweep line:

Convert [up_timestamp, down_timestamp] to , and sort all the timestamp pair, if there are two timestamps that are the same, up first.

And traverse the sorted array.