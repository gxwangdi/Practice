
Obviously dynamic programming.

Space O(n2), Time O(n2).

